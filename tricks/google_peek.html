
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Google Peek</title>
  <link rel="stylesheet" href="../../assets/css/style.css" />
</head>
<body>
  <div class="container">
    <h1>Google Peek</h1>
    <p>Let the spectator scan this link or type it on their device:</p>
    <p><code>https://appechomind.github.io/Echomind_1.0/tools/google_peek.html</code></p>

    <div style="margin-top:30px;">
      <label><input type="checkbox" id="whisperToggle" checked /> Whisper Prediction</label>
    </div>

    <button class="btn" onclick="revealThought()">Reveal Thought</button>
    <p id="result" style="margin-top:30px; font-size:20px;"></p>
  </div>

  <script>
    function speak(text) {
      const synth = window.speechSynthesis;
      if (!synth) return;
      const utter = new SpeechSynthesisUtterance(text);
      utter.rate = 0.9;
      utter.pitch = 1;
      synth.speak(utter);
    }

    function revealThought() {
      let thought = localStorage.getItem('lastQuery');
      if (thought) {
        document.getElementById('result').innerText = "üéØ Your thought was: " + thought;
        if (document.getElementById('whisperToggle').checked) {
          speak("I believe you were thinking of... " + thought);
        }
      } else {
        document.getElementById('result').innerText = "‚ùì Nothing peeked yet. Try again.";
      }
    }

    // Optional: voice command trigger
    try {
      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      const recognition = new SpeechRecognition();
      recognition.continuous = true;
      recognition.interimResults = false;
      recognition.onresult = function(event) {
        const transcript = event.results[event.results.length - 1][0].transcript.trim().toLowerCase();
        if (transcript.includes("reveal") || transcript.includes("show it")) {
          revealThought();
        }
      };
      recognition.start();
    } catch (e) {
      console.warn("Speech recognition not supported.");
    }
  </script>
</body>
</html>
