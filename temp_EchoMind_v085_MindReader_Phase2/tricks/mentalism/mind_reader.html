<html><head><title>Mind Reader</title>
<style>
@keyframes fadeInFlicker {
  0% { opacity: 0; text-shadow: none; }
  30% { opacity: 0.3; }
  60% { opacity: 0.6; text-shadow: 0 0 8px white; }
  100% { opacity: 1; text-shadow: 0 0 12px white; }
}

#liveThought span {
  display: inline-block;
  opacity: 0;
  animation: fadeInFlicker 1.2s ease forwards;
}
</style>

</head><body>
<div id="liveThought" style="position: absolute; top: 50%; left: 50%;
  transform: translate(-50%, -50%); font-size: 28px; color: white;
  text-align: center; z-index: 5; font-weight: bold;">
</div>


<script>
let recognition;
window.addEventListener("load", () => {
  if ('webkitSpeechRecognition' in window) {
    recognition = new webkitSpeechRecognition();
    recognition.lang = "en-US";
    recognition.continuous = true;
    recognition.interimResults = true;
    recognition.onresult = (event) => {
      let live = "";
      for (let i = event.resultIndex; i < event.results.length; ++i) {
        if (event.results[i].isFinal) {
          live += event.results[i][0].transcript + " ";
        }
      }
      document.getElementById("liveThought").innerText = live.trim();
      localStorage.setItem("lastVoice", live.trim());
    };
    recognition.onerror = (event) => {
      console.warn("Mic error:", event.error);
    };
    recognition.start();
  }
});

window.addEventListener("beforeunload", () => {
  if (recognition && recognition.stop) recognition.stop();
});
</script>


<script>
function animateLiveThought(text) {
  const container = document.getElementById("liveThought");
  container.innerHTML = "";
  const words = text.split(" ");
  words.forEach((word, i) => {
    const span = document.createElement("span");
    span.textContent = word + " ";
    span.style.animationDelay = `${i * 0.25}s`;
    container.appendChild(span);
  });
}

if (recognition) {
  recognition.onresult = (event) => {
    let finalPhrase = "";
    for (let i = event.resultIndex; i < event.results.length; ++i) {
      if (event.results[i].isFinal) {
        finalPhrase += event.results[i][0].transcript + " ";
      }
    }
    finalPhrase = finalPhrase.trim();
    if (finalPhrase.length > 0) {
      localStorage.setItem("lastVoice", finalPhrase);
      animateLiveThought(finalPhrase);
    }
  };
}
</script>

</body></html>